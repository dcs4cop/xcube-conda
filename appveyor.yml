image: Ubuntu

install:
  - sh: docker login -u $QUAY_USER -p $QUAY_PASSWORD quay.io
  - sh: cp .env_travis .env
  - sh: pip install --user shyaml
  - sh: sudo apt-get -y update
  - sh: sudo apt-get -y install docker-compose
  - sh: cp .env_travis .env

build_script:
  - sh: docker-compose build xcube-python-base
  - sh: docker-compose build xcube
  - sh: docker-compose build xcube-gen
  - sh: docker-compose build xcube-jupyterlab
  - sh: docker-compose build xcubehub-base --build-arg SSH_PRIVATE_KEY=${SSH_PRIVATE_KEY}

deploy_script:
  - sh: docker-compose push
#  - sh: >-
#    if [ -n "$APPVEYOR_REPO_TAG_NAME" ]; then
#      docker-compose push
#    fi;